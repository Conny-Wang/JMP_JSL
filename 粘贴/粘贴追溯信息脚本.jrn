/* JMP 16.1.0   01 */
ListBox(vertical,near,sub(
OutlineBox(
open(1),title("追溯信息脚本"),closeOrient(1),indent(13),default font id(2),scriptable,Margin({Left(2), Top(2), Right(4), Bottom(4)}),sub(
ButtonBox(title("精元"),scriptText("//!\!r\!nNames Default To Here( 1 );\!r\!n//判断桌面是否有 JMP 文件\!r\!ndrijmp = Is Directory(\!"$Desktop\!\JMP\!");\!r\!n//如果没有就创建一个 JMP 文件夹\!r\!nif (drijmp == 0,\!r\!nCreate Directory(\!"$Desktop\!\JMP\!" );\!r\!n\!tStop();\!r\!n);\!r\!n//设置桌面 JMP 文件夹为默认目录\!r\!ndri = Set Default Directory(\!"$Desktop\!\JMP\!");\!r\!n\!r\!n//批量导入需要合并的文件，默认参数，JMP 自动推导，可手动配置参数。\!r\!nmfi = Multiple File Import();\!r\!n//设置导入目录\!r\!nmfi << Set Folder(dri);\!r\!n//设置导入的编码为中文字体\!r\!nmfi<<Set Charset( \!"gb2312\!" );\!r\!n//批量导入\!r\!nmfi << Import Data();\!r\!n//获取已经开的所有表数量\!r\!nopen_tables = N Table();\!r\!n//判断数据是否合并为 1 个，如果不是说明数据格式一致。\!r\!n//如果合并发现多余2个表弹窗提醒并停止下面代码继续执行。\!r\!nif (open_tables>1,\!r\!n    win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"请检查数据\!\!r数据格式不一致\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n    Stop(),\!r\!n);\!r\!n//导入后定义当前活动表为 datatable\!r\!ndt = Current Data Table();\!r\!n//判断有没有活动表,如果没有停止运行.\!r\!nif (\!r\!n\!tIs Empty(dt),\!r\!n\!t win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"桌面 JMP 文件夹为空\!\!r请检查文件\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n\!tStop();\!r\!n);\!r\!n\!r\!n//获取机种和国别\!r\!nModle = Word( 1, :机种型号[1] );\!r\!n//获取 MB 厂商\!r\!nMBvendor = Word( 3, :机种型号[1] );\!r\!n\!r\!n//删除第一和第二列\!r\!ndt << Delete Columns(1,2);\!r\!n//设置胶水型号为 9088\!r\!nNew Column( \!"GLUE_BATCH\!", character );\!r\!ndt:GLUE_BATCH << Set Each Value(\!"9088\!");\!r\!n//设置胶水批次\!r\!nNew Column( \!"GLUE_TYPE\!", character );\!r\!n\!r\!n//设置机种为 Ramp\!r\!nNew Column( \!"BUILD_STAGE\!", character );\!r\!ndt:BUILD_STAGE << Set Each Value(\!"Ramp\!");\!r\!n//新建备注栏\!r\!nNew Column( \!"REMARKS\!", character );\!r\!n\!r\!n//重命名列名称\!r\!nNewCols = {\!"MB_SN\!", \!"ATTACH_DATE\!", \!"ATTACH_LINE\!", \!"TOOL_CODE\!",\!r\!n    \!"FIXTURE_CODE\!",\!"BR_TOOL\!",\!"SR_TOOL\!",\!"SP_TOOL\!",\!"RACK\!",\!"OVEN\!",\!r\!n    \!"AOI_ID\!",\!"JRS_ID\!",\!"PACK_ID\!"\!r\!n};\!r\!nFor( i = 1, i <= N Items( NewCols ), i++,\!r\!n Column( dt, i ) << set name( NewCols[i] )\!r\!n);\!r\!n\!r\!n//获取空格键的值\!r\!nSPValue = :SP_TOOL << Get Values;\!r\!n\!r\!n//如果空格键为空删除整列\!r\!nIf( Is Missing(SPValue[1]),\!r\!n dt << Delete Columns(\!"SP_TOOL\!"),\!r\!n);\!r\!n\!r\!n//获取总行数\!r\!ncol = Length(dt << Get Column Names);\!r\!n\!r\!n//匹配重复的 SN 并删除行\!r\!ndt << Select Duplicate Rows( Match( Column( \!"MB_SN\!" )) ) << Delete Rows;\!r\!n\!r\!n\!r\!n//格式化 attachedate 为 年/月/日 时/分/秒\!r\!n//Column( \!"ATTACH_DATE\!")<< Data Type(numeric,Format( \!"y/m/d h:m:s\!"));\!r\!n\!r\!n//统计当前表总共多少行数据\!r\!nTotalRows = N ROWS(dt);\!r\!n\!r\!n//更改表名为总行数\!r\!ndt << Set Name(\!"Sheet1\!");\!r\!n\!r\!n//获取粘贴日期\!r\!nattdate = dt:ATTACH_DATE << Get as Matrix;\!r\!n\!r\!n//新建一列 Date 用来更新胶水日期\!r\!ndatecol = New Column( \!"Date\!", numeric,Format( \!"y/m/d\!") );\!r\!ndatecol << Set Values( attdate );\!r\!nColumn( \!"Date\!")<< Data Type(Character,\!"Nominal\!");\!r\!n\!r\!n//打开胶水记录\!r\!ndt2 = Open(\!"$Desktop\!\Glue.jmp\!");\!r\!n\!r\!n//更新胶水记录\!r\!ndt << Update(\!r\!n    With( dt2 ),\!r\!n    Match Columns( :Date = :Date )\!r\!n);\!r\!n\!r\!n//关闭胶水记录\!r\!ndt2 << Close Window;\!r\!n\!r\!n//删除最后一列\!r\!ndt << Delete Columns(\!"Date\!");\!r\!n\!r\!n//正则替换粘贴日期为前三天\!r\!npattern = Pat Regex( \!"^\!\S{10}|^\!\S{9}|^\!\S{8}\!" );\!r\!nFor Each Row(\!r\!n\!t\!tdt,\!r\!n\!t\!t:ATTACH_DATE = Regex(\!r\!n\!t\!t\!t:ATTACH_DATE,\!r\!n\!t\!t\!tpattern,\!r\!n\!t\!t\!t\!"2024/01/11\!",\!r\!n\!t\!t\!t//Abbrev Date(Today()-3*24*3600),\!r\!n\!t\!t\!tGLOBALREPLACE,\!r\!n\!t\!t\!tIGNORECASE\!r\!n\!t\!t)\!r\!n\!t);\!r\!n\!t\!r\!n//今天日期\!r\!ntoday = Short Date( Today()-24*3600 );\!r\!nydyformate = Substr(char(today),1,2)||Substr(char(today),4,2)||Substr(char(today),9,2);\!r\!n\!r\!n// 替换 Ai7 为 A17\!r\!nLocal( {dt = data table(\!"Sheet1\!")},\!r\!n\!tdt << Begin Data Update;\!r\!n\!tFor Each( {col},\!r\!n\!t\!tdt << Get Column Reference( dt << Get Column Names( Character ) ),\!r\!n\!t\!tFor Each Row( dt, col[] = Substitute( col[], \!"AI7\!", \!"A17\!", <<IGNORECASE ) )\!r\!n\!t);\!r\!n\!tdt << End Data Update;\!r\!n);\!r\!n\!r\!n//保存为桌面\!r\!ndt << Save As(\!"$Desktop\!\\!" || Modle || \!" Ramp \!" || ydyformate || \!" \!" || MBvendor ||\!" Qty\!"||char(TotalRows)||\!" pcs V1.0.xlsx\!");\!r\!n//关闭数据表\!r\!n//dt << Close Window;\!r\!n\!r\!n//分割箱号\!r\!ndt << Text to Columns( columns( :PACK_ID ), Delimiters( \!" \!" ) );\!r\!n\!r\!n//重命名分割的列并删除多余的列\!r\!n:PACK_ID1 << Set Name(\!"机种国别\!");\!r\!n:PACK_ID2 << Set Name(\!"客户\!");\!r\!n:PACK_ID3 << Set Name(\!"MB厂商\!");\!r\!n dt << Delete Columns(:PACK_ID4);\!r\!n \!r\!n//此方法也可以分割箱号，但是效率慢\!r\!n\!r\!n//New Column( \!"机种国别\!", character );\!r\!n//For Each Row(:机种国别 =Items(:PACK_ID,\!" \!")[1]);\!r\!n//\!r\!n//New Column( \!"客户\!", character );\!r\!n//For Each Row(:客户 =Items(:PACK_ID,\!" \!")[2]);\!r\!n//\!r\!n//New Column( \!"MB厂商\!", character );\!r\!n//For Each Row(:MB厂商 =Items(:PACK_ID,\!" \!")[3]);\!r\!n\!r\!n \!r\!n//新建 SP TOOL\!r\!nNew Column( \!"SP TOOL\!", character );\!r\!n\!r\!n//判断空格键\!r\!n If(   col  == 17,\!r\!n \!tdt:SP TOOL << Set Formula( Substr( :SP_TOOL, 8, 3 ) ),\!r\!n \!tdt:SP TOOL << Set Formula( char(\!"无空格键\!") ),\!r\!n );\!r\!n \!r\!n/*//判断空格键\!r\!nFor Each Row(\!r\!n:SP TOOL = If( Is missing(:SP_TOOL),\!r\!n\!"无空格键\!",\!r\!nsubstr(:SP_TOOL,8,3)\!r\!n)\!r\!n);*/\!r\!n\!r\!n//转换日期为字符串\!r\!ndt:ATTACH_DATE << Data Type(numeric,Format( \!"y/m/d\!"));\!r\!ndt:ATTACH_DATE << Data Type(Character);\!r\!n\!r\!n//制作数据表\!r\!nTB = dt << Tabulate(\!r\!n    Show Control Panel( 0 ),\!r\!n    Add Table(\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_DATE ),\!r\!n            Add Aggregate Statistics( :ATTACH_DATE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_LINE ),\!r\!n            Add Aggregate Statistics( :ATTACH_LINE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :TOOL_CODE ),\!r\!n            Add Aggregate Statistics( :TOOL_CODE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :SP TOOL ),\!r\!n            Add Aggregate Statistics( :SP TOOL )\!r\!n        ),\!r\!n        Row Table(\!r\!n            Grouping Columns( :机种国别 ),\!r\!n            Add Aggregate Statistics( :机种国别 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :客户 ),\!r\!n            Add Aggregate Statistics( :客户 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :MB厂商 ),\!r\!n            Add Aggregate Statistics( :MB厂商 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :BUILD_STAGE ),\!r\!n            Add Aggregate Statistics( :BUILD_STAGE )\!r\!n        ),\!r\!n        \!r\!n        \!r\!n        /*Row Table(\!r\!n            Grouping Columns( :REMARKS ),\!r\!n            Add Aggregate Statistics( :REMARKS )\!r\!n        )*/\!r\!n        \!r\!n    )\!r\!n);\!r\!n\!r\!nTB << Move window( 1600, 100 );\!r\!n"),Margin({Left(0), Top(4), Right(4), Bottom(4)}),),
ButtonBox(title("纬创"),scriptText("//!\!r\!nNames Default To Here( 1 );\!r\!n//判断桌面是否有 JMP 文件\!r\!ndrijmp = Is Directory(\!"$Desktop\!\JMP\!");\!r\!n//如果没有就创建一个 JMP 文件夹\!r\!nif (drijmp == 0,\!r\!nCreate Directory(\!"$Desktop\!\JMP\!" ));\!r\!n//设置桌面 JMP 文件夹为默认目录\!r\!ndri = Set Default Directory(\!"$Desktop\!\JMP\!");\!r\!n\!r\!n//批量导入需要合并的文件，默认参数，JMP 自动推导，可手动配置参数。\!r\!nmfi = Multiple File Import();\!r\!n//设置导入目录\!r\!nmfi << Set Folder(dri);\!r\!n//设置导入的编码为中文字体\!r\!nmfi<<Set Charset( \!"gb2312\!" );\!r\!n//批量导入\!r\!nmfi << Import Data();\!r\!n//获取已经开的所有表数量\!r\!nopen_tables = N Table();\!r\!n//判断数据是否合并为 1 个，如果不是说明数据格式一致。\!r\!n//如果合并发现多余2个表弹窗提醒并停止下面代码继续执行。\!r\!nif (open_tables>1,\!r\!n    win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"请检查数据\!\!r数据格式不一致\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n    Stop(),\!r\!n);\!r\!n//导入后定义当前活动表为 datatable\!r\!ndt = Current Data Table();\!r\!n//判断有没有活动表,如果没有停止运行.\!r\!nif (\!r\!n\!tIs Empty(dt),\!r\!n\!t win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"桌面 JMP 文件夹为空\!\!r请检查文件\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n\!tStop();\!r\!n);\!r\!n\!r\!n//获取机种和国别\!r\!nModle = Word( 1, :机种型号[1] );\!r\!n//获取 MB 厂商\!r\!nMBvendor = Word( 3, :机种型号[1] );\!r\!n\!r\!n//删除第一和第二列\!r\!ndt << Delete Columns(1,2);\!r\!n//设置胶水型号为 9088\!r\!nNew Column( \!"GLUE_BATCH\!", character );\!r\!ndt:GLUE_BATCH << Set Each Value(\!"9088\!");\!r\!n//设置胶水批次\!r\!nNew Column( \!"GLUE_TYPE\!", character );\!r\!n\!r\!n//设置机种为 Ramp\!r\!nNew Column( \!"BUILD_STAGE\!", character );\!r\!ndt:BUILD_STAGE << Set Each Value(\!"Ramp\!");\!r\!n//新建备注栏\!r\!nNew Column( \!"REMARKS\!", character );\!r\!n\!r\!n//重命名列名称\!r\!nNewCols = {\!"MB_SN\!", \!"ATTACH_DATE\!", \!"ATTACH_LINE\!", \!"TOOL_CODE\!",\!r\!n    \!"FIXTURE_CODE\!",\!"BR_TOOL\!",\!"SR_TOOL\!",\!"SP_TOOL\!",\!"RACK\!",\!"OVEN\!",\!r\!n    \!"AOI_ID\!",\!"JRS_ID\!",\!"PACK_ID\!"\!r\!n};\!r\!nFor( i = 1, i <= N Items( NewCols ), i++,\!r\!n Column( dt, i ) << set name( NewCols[i] )\!r\!n);\!r\!n\!r\!n//获取空格键的值\!r\!nSPValue = :SP_TOOL << Get Values;\!r\!n\!r\!n//如果空格键为空删除整列\!r\!nIf( Is Missing(SPValue[1]),\!r\!n dt << Delete Columns(\!"SP_TOOL\!"),\!r\!n);\!r\!n\!r\!n//获取总行数\!r\!ncol = Length(dt << Get Column Names);\!r\!n\!r\!n\!r\!n//匹配重复的 SN 并删除行\!r\!ndt << Select Duplicate Rows( Match( Column( \!"MB_SN\!" )) ) << Delete Rows;\!r\!n\!r\!n//格式化 attachedate 为 年/月/日 时/分/秒\!r\!n//Column( \!"ATTACH_DATE\!")<< Data Type(numeric,Format( \!"y/m/d h:m:s\!"));\!r\!n\!r\!n//统计当前表总共多少行数据\!r\!nTotalRows = N ROWS(dt);\!r\!n\!r\!n//更改表名为总行数\!r\!ndt << Set Name(\!"Sheet1\!");\!r\!n\!r\!n//获取粘贴日期\!r\!nattdate = dt:ATTACH_DATE << Get as Matrix;\!r\!n\!r\!n//新建一列 Date 用来更新胶水日期\!r\!ndatecol = New Column( \!"Date\!", numeric,Format( \!"y/m/d\!") );\!r\!ndatecol << Set Values( attdate );\!r\!nColumn( \!"Date\!")<< Data Type(Character,\!"Nominal\!");\!r\!n\!r\!n//打开胶水记录\!r\!ndt2 = Open(\!"$Desktop\!\Glue.jmp\!");\!r\!n\!r\!n//更新胶水记录\!r\!ndt << Update(\!r\!n    With( dt2 ),\!r\!n    Match Columns( :Date = :Date )\!r\!n);\!r\!n\!r\!n//关闭胶水记录\!r\!ndt2 << Close Window;\!r\!n\!r\!n//删除最后一列\!r\!ndt << Delete Columns(\!"Date\!");\!r\!n\!r\!n//今天日期\!r\!ntoday = Short Date( Today()-24*3600 );\!r\!nydyformate = Substr(char(today),1,2)||Substr(char(today),4,2)||Substr(char(today),9,2);\!r\!n\!r\!n// 替换 Ai7 为 A17\!r\!nLocal( {dt = data table(\!"Sheet1\!")},\!r\!n\!tdt << Begin Data Update;\!r\!n\!tFor Each( {col},\!r\!n\!t\!tdt << Get Column Reference( dt << Get Column Names( Character ) ),\!r\!n\!t\!tFor Each Row( dt, col[] = Substitute( col[], \!"AI7\!", \!"A17\!", <<IGNORECASE ) )\!r\!n\!t);\!r\!n\!tdt << End Data Update;\!r\!n);\!r\!n\!r\!n//保存为桌面\!r\!ndt << Save As(\!"$Desktop\!\纬创\!" || Modle || \!" Ramp \!" || ydyformate || \!" \!" || MBvendor ||\!" Qty\!"||char(TotalRows)||\!" pcs V1.0.xlsx\!");\!r\!n//关闭数据表\!r\!n//dt << Close Window;\!r\!n\!r\!n//分割箱号\!r\!ndt << Text to Columns( columns( :PACK_ID ), Delimiters( \!" \!" ) );\!r\!n\!r\!n//重命名分割的列并删除多余的列\!r\!n:PACK_ID1 << Set Name(\!"机种国别\!");\!r\!n:PACK_ID2 << Set Name(\!"客户\!");\!r\!n:PACK_ID3 << Set Name(\!"MB厂商\!");\!r\!n dt << Delete Columns(:PACK_ID4);\!r\!n \!r\!n//此方法也可以分割箱号，但是效率慢\!r\!n\!r\!n//New Column( \!"机种国别\!", character );\!r\!n//For Each Row(:机种国别 =Items(:PACK_ID,\!" \!")[1]);\!r\!n//\!r\!n//New Column( \!"客户\!", character );\!r\!n//For Each Row(:客户 =Items(:PACK_ID,\!" \!")[2]);\!r\!n//\!r\!n//New Column( \!"MB厂商\!", character );\!r\!n//For Each Row(:MB厂商 =Items(:PACK_ID,\!" \!")[3]);\!r\!n\!r\!n \!r\!n//新建 SP TOOL\!r\!nNew Column( \!"SP TOOL\!", character );\!r\!n\!r\!n//判断空格键\!r\!n If(   col  == 17,\!r\!n \!tdt:SP TOOL << Set Formula( Substr( :SP_TOOL, 8, 3 ) ),\!r\!n \!tdt:SP TOOL << Set Formula( char(\!"无空格键\!") ),\!r\!n );\!r\!n \!r\!n/*//判断空格键\!r\!nFor Each Row(\!r\!n:SP TOOL = If( Is missing(:SP_TOOL),\!r\!n\!"无空格键\!",\!r\!nsubstr(:SP_TOOL,8,3)\!r\!n)\!r\!n);*/\!r\!n\!r\!n//转换日期为字符串\!r\!ndt:ATTACH_DATE << Data Type(numeric,Format( \!"y/m/d\!"));\!r\!ndt:ATTACH_DATE << Data Type(Character);\!r\!n\!r\!n//制作数据表\!r\!nTB = dt << Tabulate(\!r\!n    Show Control Panel( 0 ),\!r\!n    Add Table(\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_DATE ),\!r\!n            Add Aggregate Statistics( :ATTACH_DATE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_LINE ),\!r\!n            Add Aggregate Statistics( :ATTACH_LINE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :TOOL_CODE ),\!r\!n            Add Aggregate Statistics( :TOOL_CODE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :SP TOOL ),\!r\!n            Add Aggregate Statistics( :SP TOOL )\!r\!n        ),\!r\!n        Row Table(\!r\!n            Grouping Columns( :机种国别 ),\!r\!n            Add Aggregate Statistics( :机种国别 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :客户 ),\!r\!n            Add Aggregate Statistics( :客户 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :MB厂商 ),\!r\!n            Add Aggregate Statistics( :MB厂商 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :BUILD_STAGE ),\!r\!n            Add Aggregate Statistics( :BUILD_STAGE )\!r\!n        ),\!r\!n        \!r\!n        \!r\!n        /*Row Table(\!r\!n            Grouping Columns( :REMARKS ),\!r\!n            Add Aggregate Statistics( :REMARKS )\!r\!n        )*/\!r\!n        \!r\!n    )\!r\!n);\!r\!n\!r\!nTB << Move window( 1600, 100 );"),Margin({Left(0), Top(4), Right(4), Bottom(4)}),),
ButtonBox(title("领略"),scriptText("//!\!r\!nNames Default To Here( 1 );\!r\!n//判断桌面是否有 JMP 文件\!r\!ndrijmp = Is Directory(\!"$Desktop\!\JMP\!");\!r\!n//如果没有就创建一个 JMP 文件夹\!r\!nif (drijmp == 0,\!r\!nCreate Directory(\!"$Desktop\!\JMP\!" ));\!r\!n//设置桌面 JMP 文件夹为默认目录\!r\!ndri = Set Default Directory(\!"$Desktop\!\JMP\!");\!r\!n\!r\!n//批量导入需要合并的文件，默认参数，JMP 自动推导，可手动配置参数。\!r\!nmfi = Multiple File Import();\!r\!n//设置导入目录\!r\!nmfi << Set Folder(dri);\!r\!n//设置导入的编码为中文字体\!r\!nmfi<<Set Charset( \!"gb2312\!" );\!r\!n//批量导入\!r\!nmfi << Import Data();\!r\!n//获取已经开的所有表数量\!r\!nopen_tables = N Table();\!r\!n//判断数据是否合并为 1 个，如果不是说明数据格式一致。\!r\!n//如果合并发现多余2个表弹窗提醒并停止下面代码继续执行。\!r\!nif (open_tables>1,\!r\!n    win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"请检查数据\!\!r数据格式不一致\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n    Stop(),\!r\!n);\!r\!n//导入后定义当前活动表为 datatable\!r\!ndt = Current Data Table();\!r\!n//判断有没有活动表,如果没有停止运行.\!r\!nif (\!r\!n\!tIs Empty(dt),\!r\!n\!t win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"桌面 JMP 文件夹为空\!\!r请检查文件\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n\!tStop();\!r\!n);\!r\!n\!r\!n//获取机种和国别\!r\!nModle = Word( 1, :机种型号[1] );\!r\!n//获取 MB 厂商\!r\!nMBvendor = Word( 3, :机种型号[1] );\!r\!n\!r\!n\!r\!n//删除第一和第二列\!r\!ndt << Delete Columns(1,2);\!r\!n//设置胶水型号为 9088\!r\!nNew Column( \!"GLUE_BATCH\!", character );\!r\!ndt:GLUE_BATCH << Set Each Value(\!"9088\!");\!r\!n//设置胶水批次\!r\!nNew Column( \!"GLUE_TYPE\!", character );\!r\!n\!r\!n//设置机种为 Ramp\!r\!nNew Column( \!"BUILD_STAGE\!", character );\!r\!ndt:BUILD_STAGE << Set Each Value(\!"Ramp\!");\!r\!n//新建备注栏\!r\!nNew Column( \!"REMARKS\!", character );\!r\!n\!r\!n//重命名列名称\!r\!nNewCols = {\!"MB_SN\!", \!"ATTACH_DATE\!", \!"ATTACH_LINE\!", \!"TOOL_CODE\!",\!r\!n    \!"FIXTURE_CODE\!",\!"BR_TOOL\!",\!"SR_TOOL\!",\!"SP_TOOL\!",\!"RACK\!",\!"OVEN\!",\!r\!n    \!"AOI_ID\!",\!"JRS_ID\!",\!"PACK_ID\!"\!r\!n};\!r\!nFor( i = 1, i <= N Items( NewCols ), i++,\!r\!n Column( dt, i ) << set name( NewCols[i] )\!r\!n);\!r\!n\!r\!n//获取空格键的值\!r\!nSPValue = :SP_TOOL << Get Values;\!r\!n\!r\!n//如果空格键为空删除整列\!r\!nIf( Is Missing(SPValue[1]),\!r\!n dt << Delete Columns(\!"SP_TOOL\!"),\!r\!n);\!r\!n\!r\!n//获取总行数\!r\!ncol = Length(dt << Get Column Names);\!r\!n\!r\!n//匹配重复的 SN 并删除行\!r\!ndt << Select Duplicate Rows( Match( Column( \!"MB_SN\!" )) ) << Delete Rows;\!r\!n\!r\!n//格式化 attachedate 为 年/月/日 时/分/秒\!r\!n//Column( \!"ATTACH_DATE\!")<< Data Type(numeric,Format( \!"y/m/d h:m:s\!"));\!r\!n\!r\!n//统计当前表总共多少行数据\!r\!nTotalRows = N ROWS(dt);\!r\!n\!r\!n//更改表名为总行数\!r\!ndt << Set Name(\!"Sheet1\!");\!r\!n\!r\!n//获取粘贴日期\!r\!nattdate = dt:ATTACH_DATE << Get as Matrix;\!r\!n\!r\!n//新建一列 Date 用来更新胶水日期\!r\!ndatecol = New Column( \!"Date\!", numeric,Format( \!"y/m/d\!") );\!r\!ndatecol << Set Values( attdate );\!r\!nColumn( \!"Date\!")<< Data Type(Character,\!"Nominal\!");\!r\!n\!r\!n//打开胶水记录\!r\!ndt2 = Open(\!"$Desktop\!\Glue.jmp\!");\!r\!n\!r\!n//更新胶水记录\!r\!ndt << Update(\!r\!n    With( dt2 ),\!r\!n    Match Columns( :Date = :Date )\!r\!n);\!r\!n\!r\!n//关闭胶水记录\!r\!ndt2 << Close Window;\!r\!n\!r\!n//删除最后一列\!r\!ndt << Delete Columns(\!"Date\!");\!r\!n\!r\!n//今天日期\!r\!ntoday = Short Date( Today()-24*3600 );\!r\!nydyformate = Substr(char(today),1,2)||Substr(char(today),4,2)||Substr(char(today),9,2);\!r\!n\!r\!n// 替换 Ai7 为 A17\!r\!nLocal( {dt = data table(\!"Sheet1\!")},\!r\!n\!tdt << Begin Data Update;\!r\!n\!tFor Each( {col},\!r\!n\!t\!tdt << Get Column Reference( dt << Get Column Names( Character ) ),\!r\!n\!t\!tFor Each Row( dt, col[] = Substitute( col[], \!"AI7\!", \!"A17\!", <<IGNORECASE ) )\!r\!n\!t);\!r\!n\!tdt << End Data Update;\!r\!n);\!r\!n\!r\!n\!r\!n//保存为桌面\!r\!ndt << Save As(\!"$Desktop\!\\!" || Modle || \!" Ramp \!" || ydyformate || \!" \!" || MBvendor ||\!" Qty\!"||char(TotalRows)||\!" pcs V1.0.xlsx\!");\!r\!n//关闭数据表\!r\!n//dt << Close Window;\!r\!n\!r\!n//分割箱号\!r\!ndt << Text to Columns( columns( :PACK_ID ), Delimiters( \!" \!" ) );\!r\!n\!r\!n//重命名分割的列并删除多余的列\!r\!n:PACK_ID1 << Set Name(\!"机种国别\!");\!r\!n:PACK_ID2 << Set Name(\!"客户\!");\!r\!n:PACK_ID3 << Set Name(\!"MB厂商\!");\!r\!ndt << Delete Columns(:PACK_ID4);\!r\!n \!r\!n//此方法也可以分割箱号，但是效率慢\!r\!n\!r\!n//New Column( \!"机种国别\!", character );\!r\!n//For Each Row(:机种国别 =Items(:PACK_ID,\!" \!")[1]);\!r\!n//\!r\!n//New Column( \!"客户\!", character );\!r\!n//For Each Row(:客户 =Items(:PACK_ID,\!" \!")[2]);\!r\!n//\!r\!n//New Column( \!"MB厂商\!", character );\!r\!n//For Each Row(:MB厂商 =Items(:PACK_ID,\!" \!")[3]);\!r\!n\!r\!n \!r\!n//新建 SP TOOL\!r\!nNew Column( \!"SP TOOL\!", character );\!r\!n\!r\!n//判断空格键\!r\!n If(   col  == 17,\!r\!n \!tdt:SP TOOL << Set Formula( Substr( :SP_TOOL, 8, 3 ) ),\!r\!n \!tdt:SP TOOL << Set Formula( char(\!"无空格键\!") ),\!r\!n );\!r\!n \!r\!n/*For Each Row(\!r\!n:SP TOOL = If( Is missing(:SP_TOOL),\!r\!n\!"无空格键\!",\!r\!nsubstr(:SP_TOOL,8,3)\!r\!n)\!r\!n);*/\!r\!n\!r\!n//转换日期为字符串\!r\!ndt:ATTACH_DATE << Data Type(numeric,Format( \!"y/m/d\!"));\!r\!ndt:ATTACH_DATE << Data Type(Character);\!r\!n\!r\!n//制作数据表\!r\!nTB = dt << Tabulate(\!r\!n    Show Control Panel( 0 ),\!r\!n    Add Table(\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_DATE ),\!r\!n            Add Aggregate Statistics( :ATTACH_DATE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_LINE ),\!r\!n            Add Aggregate Statistics( :ATTACH_LINE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :TOOL_CODE ),\!r\!n            Add Aggregate Statistics( :TOOL_CODE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :SP TOOL ),\!r\!n            Add Aggregate Statistics( :SP TOOL )\!r\!n        ),\!r\!n        Row Table(\!r\!n            Grouping Columns( :机种国别 ),\!r\!n            Add Aggregate Statistics( :机种国别 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :客户 ),\!r\!n            Add Aggregate Statistics( :客户 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :MB厂商 ),\!r\!n            Add Aggregate Statistics( :MB厂商 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :BUILD_STAGE ),\!r\!n            Add Aggregate Statistics( :BUILD_STAGE )\!r\!n        ),\!r\!n        \!r\!n        \!r\!n        /*Row Table(\!r\!n            Grouping Columns( :REMARKS ),\!r\!n            Add Aggregate Statistics( :REMARKS )\!r\!n        )*/\!r\!n        \!r\!n    )\!r\!n);\!r\!n// add tool_code counts\!r\!nTB2 = dt << Tabulate(\!r\!n\!tShow Control Panel( 0 ),\!r\!n\!tAdd Table(\!r\!n\!t\!tRow Table(\!r\!n\!t\!t\!tGrouping Columns( :TOOL_CODE, :ATTACH_DATE ),\!r\!n\!t\!t\!tAdd Aggregate Statistics( :TOOL_CODE )\!r\!n\!t\!t)\!r\!n\!t)\!r\!n);\!r\!n\!r\!nTB << Move window( 1600, 100 );\!r\!nTB2 << Move window( 900, 300 );"),Margin({Left(0), Top(4), Right(4), Bottom(4)}),),
ButtonBox(title("FJK 定制"),scriptText("//!\!r\!nNames Default To Here( 1 );\!r\!n//判断桌面是否有 JMP 文件\!r\!ndrijmp = Is Directory(\!"$Desktop\!\JMP\!");\!r\!n//如果没有就创建一个 JMP 文件夹\!r\!nif (drijmp == 0,\!r\!nCreate Directory(\!"$Desktop\!\JMP\!" ));\!r\!n//设置桌面 JMP 文件夹为默认目录\!r\!ndri = Set Default Directory(\!"$Desktop\!\JMP\!");\!r\!n\!r\!n//批量导入需要合并的文件，默认参数，JMP 自动推导，可手动配置参数。\!r\!nmfi = Multiple File Import();\!r\!n//设置导入目录\!r\!nmfi << Set Folder(dri);\!r\!n//设置导入的编码为中文字体\!r\!nmfi<<Set Charset( \!"gb2312\!" );\!r\!n//批量导入\!r\!nmfi << Import Data();\!r\!n//获取已经开的所有表数量\!r\!nopen_tables = N Table();\!r\!n//判断数据是否合并为 1 个，如果不是说明数据格式一致。\!r\!n//如果合并发现多余2个表弹窗提醒并停止下面代码继续执行。\!r\!nif (open_tables>1,\!r\!n    win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"请检查数据\!\!r数据格式不一致\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n    Stop(),\!r\!n);\!r\!n//导入后定义当前活动表为 datatable\!r\!ndt = Current Data Table();\!r\!n//判断有没有活动表,如果没有停止运行.\!r\!nif (\!r\!n\!tIs Empty(dt),\!r\!n\!t win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"桌面 JMP 文件夹为空\!\!r请检查文件\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n\!tStop();\!r\!n);\!r\!n//删除第一和第二列\!r\!ndt << Delete Columns(1,2);\!r\!n//设置胶水型号为 9088\!r\!nNew Column( \!"GLUE_BATCH\!", character );\!r\!ndt:GLUE_BATCH << Set Each Value(\!"9088\!");\!r\!n//设置胶水批次\!r\!nNew Column( \!"GLUE_TYPE\!", character );\!r\!n\!r\!n//设置机种为 Ramp\!r\!nNew Column( \!"BUILD_STAGE\!", character );\!r\!ndt:BUILD_STAGE << Set Each Value(\!"Ramp\!");\!r\!n//新建备注栏\!r\!nNew Column( \!"REMARKS\!", character );\!r\!n\!r\!n//重命名列名称\!r\!nNewCols = {\!"MB_SN\!", \!"ATTACH_DATE\!", \!"ATTACH_LINE\!", \!"TOOL_CODE\!",\!r\!n    \!"FIXTURE_CODE\!",\!"BR_TOOL\!",\!"SR_TOOL\!",\!"SP_TOOL\!",\!"RACK\!",\!"OVEN\!",\!r\!n    \!"AOI_ID\!",\!"JRS_ID\!",\!"PACK_ID\!"\!r\!n};\!r\!nFor( i = 1, i <= N Items( NewCols ), i++,\!r\!n Column( dt, i ) << set name( NewCols[i] )\!r\!n);\!r\!n\!r\!n//获取空格键的值\!r\!nSPValue = :SP_TOOL << Get Values;\!r\!n\!r\!n//如果空格键为空删除整列\!r\!nIf( Is Missing(SPValue[1]),\!r\!n dt << Delete Columns(\!"SP_TOOL\!"),\!r\!n);\!r\!n\!r\!n//获取总行数\!r\!ncol = Length(dt << Get Column Names);\!r\!n\!r\!n//匹配重复的 SN 并删除行\!r\!ndt << Select Duplicate Rows( Match( Column( \!"MB_SN\!" )) ) << Delete Rows;\!r\!n\!r\!n//格式化 attachedate 为 年/月/日 时/分/秒\!r\!n//Column( \!"ATTACH_DATE\!")<< Data Type(numeric,Format( \!"y/m/d h:m:s\!"));\!r\!n\!r\!n//统计当前表总共多少行数据\!r\!nTotalRows = N ROWS(dt);\!r\!n\!r\!n//更改表名为总行数\!r\!ndt << Set Name(\!"Sheet1\!");\!r\!n\!r\!n//获取粘贴日期\!r\!nattdate = dt:ATTACH_DATE << Get as Matrix;\!r\!n\!r\!n//新建一列 Date 用来更新胶水日期\!r\!ndatecol = New Column( \!"Date\!", numeric,Format( \!"y/m/d\!") );\!r\!ndatecol << Set Values( attdate );\!r\!nColumn( \!"Date\!")<< Data Type(Character,\!"Nominal\!");\!r\!n\!r\!n//打开胶水记录\!r\!ndt2 = Open(\!"$Desktop\!\Glue.jmp\!");\!r\!n\!r\!n//更新胶水记录\!r\!ndt << Update(\!r\!n    With( dt2 ),\!r\!n    Match Columns( :Date = :Date )\!r\!n);\!r\!n\!r\!n//关闭胶水记录\!r\!ndt2 << Close Window;\!r\!n\!r\!n//删除最后一列\!r\!ndt << Delete Columns(\!"Date\!");\!r\!n\!r\!n//今天日期\!r\!ntoday = Short Date( Today()-24*3600 );\!r\!nydyformate = Substr(char(today),1,2)||Substr(char(today),4,2)||Substr(char(today),9,2);\!r\!n\!r\!n//保存为桌面\!r\!ndt << Save As(\!"$Desktop\!\X1726-ISO Ramp \!"||ydyformate||\!" GODA Qty\!"||char(TotalRows)||\!" pcs V1.0.xlsx\!");\!r\!n//关闭数据表\!r\!n//dt << Close Window;\!r\!n\!r\!n//分割箱号\!r\!ndt << Text to Columns( columns( :PACK_ID ), Delimiters( \!" \!" ) );\!r\!ndt << Text to Columns( columns( :PACK_ID 3 ), Delimiters( \!"IRI\!" ) );\!r\!n//重命名分割的列并删除多余的列\!r\!n:PACK_ID1 << Set Name(\!"机种国别\!");\!r\!n:PACK_ID2 << Set Name(\!"客户\!");\!r\!n:PACK_ID 3 1 << Set Name(\!"MB厂商\!");\!r\!n \!r\!n//此方法也可以分割箱号，但是效率慢\!r\!n\!r\!n//New Column( \!"机种国别\!", character );\!r\!n//For Each Row(:机种国别 =Items(:PACK_ID,\!" \!")[1]);\!r\!n//\!r\!n//New Column( \!"客户\!", character );\!r\!n//For Each Row(:客户 =Items(:PACK_ID,\!" \!")[2]);\!r\!n//\!r\!n//New Column( \!"MB厂商\!", character );\!r\!n//For Each Row(:MB厂商 =Items(:PACK_ID,\!" \!")[3]);\!r\!n\!r\!n \!r\!n//新建 SP TOOL\!r\!nNew Column( \!"SP TOOL\!", character );\!r\!n\!r\!n//判断空格键\!r\!n If(   col  == 17,\!r\!n \!tdt:SP TOOL << Set Formula( Substr( :SP_TOOL, 8, 3 ) ),\!r\!n \!tdt:SP TOOL << Set Formula( char(\!"无空格键\!") ),\!r\!n );\!r\!n \!r\!n/*//判断空格键\!r\!nFor Each Row(\!r\!n:SP TOOL = If( Is missing(:SP_TOOL),\!r\!n\!"无空格键\!",\!r\!nsubstr(:SP_TOOL,8,3)\!r\!n)\!r\!n);*/\!r\!n\!r\!n//转换日期为字符串\!r\!ndt:ATTACH_DATE << Data Type(numeric,Format( \!"y/m/d\!"));\!r\!ndt:ATTACH_DATE << Data Type(Character);\!r\!n\!r\!n//制作数据表\!r\!nTB = dt << Tabulate(\!r\!n    Show Control Panel( 0 ),\!r\!n    Add Table(\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_DATE ),\!r\!n            Add Aggregate Statistics( :ATTACH_DATE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_LINE ),\!r\!n            Add Aggregate Statistics( :ATTACH_LINE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :TOOL_CODE ),\!r\!n            Add Aggregate Statistics( :TOOL_CODE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :SP TOOL ),\!r\!n            Add Aggregate Statistics( :SP TOOL )\!r\!n        ),\!r\!n        Row Table(\!r\!n            Grouping Columns( :机种国别 ),\!r\!n            Add Aggregate Statistics( :机种国别 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :客户 ),\!r\!n            Add Aggregate Statistics( :客户 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :MB厂商 ),\!r\!n            Add Aggregate Statistics( :MB厂商 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :BUILD_STAGE ),\!r\!n            Add Aggregate Statistics( :BUILD_STAGE )\!r\!n        ),\!r\!n        \!r\!n        \!r\!n        /*Row Table(\!r\!n            Grouping Columns( :REMARKS ),\!r\!n            Add Aggregate Statistics( :REMARKS )\!r\!n        )*/\!r\!n        \!r\!n    )\!r\!n);\!r\!n\!r\!nTB << Move window( 1600, 100 );"),Margin({Left(0), Top(4), Right(4), Bottom(4)}),))),
OutlineBox(
open(1),title("包装1脚本"),closeOrient(1),indent(13),default font id(2),scriptable,Margin({Left(2), Top(2), Right(2), Bottom(2)}),sub(
ButtonBox(title("包装1合并"),scriptText("//!\!r\!nNames Default To Here( 1 );\!r\!n//判断桌面是否有 JMP 文件\!r\!ndrijmp = Is Directory(\!"$Desktop\!\JMP\!");\!r\!n//如果没有就创建一个 JMP 文件夹\!r\!nif (drijmp == 0,\!r\!nCreate Directory(\!"$Desktop\!\JMP\!" ));\!r\!n//设置桌面 JMP 文件夹为默认目录\!r\!ndri = Set Default Directory(\!"$Desktop\!\JMP\!");\!r\!n\!r\!n//批量导入需要合并的文件，默认参数，JMP 自动推导，可手动配置参数。\!r\!nmfi = Multiple File Import();\!r\!n//设置导入目录\!r\!nmfi << Set Folder(dri);\!r\!n//设置导入的编码为中文字体\!r\!nmfi<<Set Charset( \!"gb2312\!" );\!r\!n//导入文件名\!r\!nmfi<<Set Add File Name Column( 1 );\!r\!n//批量导入\!r\!nmfi << Import Data();\!r\!n//获取已经开的所有表数量\!r\!nopen_tables = N Table();\!r\!n//判断数据是否合并为 1 个，如果不是说明数据格式一致。\!r\!n//如果合并发现多余2个表弹窗提醒并停止下面代码继续执行。\!r\!nif (open_tables>1,\!r\!n    win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"请检查数据\!\!r数据格式不一致\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n    Stop(),\!r\!n);\!r\!n//导入后定义当前活动表为 datatable\!r\!ndt = Current Data Table();\!r\!n//判断有没有活动表,如果没有停止运行.\!r\!nif (\!r\!n\!tIs Empty(dt),\!r\!n\!t win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"桌面 JMP 文件夹为空\!\!r请检查文件\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n\!tStop();\!r\!n);\!r\!n//删除第一和第二列\!r\!ndt << Delete Columns(1,2);\!r\!n\!r\!n//重命名列名称\!r\!nNewCols = {\!"MB_SN\!", \!"ATTACH_DATE\!", \!"ATTACH_LINE\!", \!"TOOL_CODE\!",\!r\!n    \!"FIXTURE_CODE\!",\!"BR_TOOL\!",\!"SR_TOOL\!",\!"SP_TOOL\!",\!"RACK\!",\!"OVEN\!",\!r\!n    \!"AOI_ID\!",\!"JRS_ID\!",\!"PACK_ID1\!"\!r\!n};\!r\!nFor( i = 1, i <= N Items( NewCols ), i++,\!r\!n Column( dt, i ) << set name( NewCols[i] )\!r\!n);\!r\!n\!r\!n//新建一个箱号列，把箱号写进去\!r\!npick = New Column( \!"PACK_ID\!", character );\!r\!nFor Each Row(:PACK_ID =Items(:PACK_ID1,\!".\!")[1]);\!r\!n\!r\!n//删除多余的包装列\!r\!ndt << Delete Columns(13);\!r\!n\!r\!n\!r\!n//匹配重复的 SN 并删除行\!r\!ndt << Select Duplicate Rows( Match( Column( \!"MB_SN\!" )) ) << Delete Rows;\!r\!n\!r\!n//设置胶水型号为 9088\!r\!nNew Column( \!"GLUE_BATCH\!", character );\!r\!ndt:GLUE_BATCH << Set Each Value(\!"9088\!");\!r\!n\!r\!n//设置胶水批次\!r\!nNew Column( \!"GLUE_TYPE\!", character );\!r\!n\!r\!n//设置机种为 Ramp\!r\!nNew Column( \!"BUILD_STAGE\!", character );\!r\!ndt:BUILD_STAGE << Set Each Value(\!"Ramp\!");\!r\!n\!r\!n//新建备注栏\!r\!nNew Column( \!"REMARKS\!", character );\!r\!n\!r\!n//截取 大小 Dome 模号\!r\!ndt:TOOL_CODE << Set Formula( Substr( :BR_TOOL, 3, 8 ) || \!" \!" || Substr( :SR_TOOL, 3, 8 ) );\!r\!n\!r\!n//格式化 attachedate 为 年/月/日 时/分/秒\!r\!n//Column( \!"ATTACH_DATE\!")<< Data Type(numeric,Format( \!"y/m/d h:m:s\!"));\!r\!n\!r\!n//获取空格键的值\!r\!nSPValue = :SP_TOOL << Get Values;\!r\!n\!r\!n//如果空格键为空删除整列\!r\!nIf( Is Missing(SPValue[1]),\!r\!n dt << Delete Columns(\!"SP_TOOL\!"),\!r\!n);\!r\!n\!r\!n//获取总行数\!r\!ncol = Length(dt << Get Column Names);\!r\!n\!r\!n//统计当前表总共多少行数据\!r\!nTotalRows = N ROWS(dt);\!r\!n\!r\!n//更改表名为总行数\!r\!ndt << Set Name(char(TotalRows)||\!"pcs\!");\!r\!n\!r\!n//获取粘贴日期\!r\!nattdate = dt:ATTACH_DATE << Get as Matrix;\!r\!n\!r\!n//新建一列 Date 用来更新胶水日期\!r\!ndatecol = New Column( \!"Date\!", numeric,Format( \!"y/m/d\!") );\!r\!ndatecol << Set Values( attdate );\!r\!nColumn( \!"Date\!")<< Data Type(Character,\!"Nominal\!");\!r\!n\!r\!n//打开胶水记录\!r\!ndt2 = Open(\!"$Desktop\!\Glue.jmp\!");\!r\!n\!r\!n//更新胶水记录\!r\!ndt << Update(\!r\!n    With( dt2 ),\!r\!n    Match Columns( :Date = :Date )\!r\!n);\!r\!n\!r\!n//关闭胶水记录\!r\!ndt2 << Close Window;\!r\!n\!r\!n//删除最后一列\!r\!ndt << Delete Columns(\!"Date\!");\!r\!n\!r\!n//今天日期\!r\!ntoday = Short Date( Today()-24*3600 );\!r\!nydyformate = Substr(char(today),1,2)||Substr(char(today),4,2)||Substr(char(today),9,2);\!r\!n\!r\!n// 替换 Ai7 为 A17\!r\!nLocal( {dt = data table(\!"Sheet1\!")},\!r\!n\!tdt << Begin Data Update;\!r\!n\!tFor Each( {col},\!r\!n\!t\!tdt << Get Column Reference( dt << Get Column Names( Character ) ),\!r\!n\!t\!tFor Each Row( dt, col[] = Substitute( col[], \!"AI7\!", \!"A17\!", <<IGNORECASE ) )\!r\!n\!t);\!r\!n\!tdt << End Data Update;\!r\!n);\!r\!n\!r\!n\!r\!n//保存为桌面\!r\!ndt << Save As(\!"$Desktop\!\X1726-ISO Ramp \!"||ydyformate||\!" GODA Qty\!"||char(TotalRows)||\!" pcs V1.0.xlsx\!");\!r\!n\!r\!n//关闭数据表\!r\!n//dt << Close Window;\!r\!n\!r\!ndt:ATTACH_DATE << Data Type(numeric,Format( \!"y/m/d\!"));\!r\!ndt:ATTACH_DATE << Data Type(Character);\!r\!n\!r\!n\!r\!n//新建 SP TOOL\!r\!nNew Column( \!"SP TOOL\!", character );\!r\!n\!r\!n//判断空格键\!r\!nIf(   col  == 17,\!r\!n \!tdt:SP TOOL << Set Formula( Substr( :SP_TOOL, 8, 3 ) ),\!r\!n \!tdt:SP TOOL << Set Formula( char(\!"无空格键\!") ),\!r\!n);\!r\!n /*\!r\!n//判断空格键\!r\!nFor Each Row(\!r\!n:SP TOOL = If( Is missing(:SP_TOOL),\!r\!n\!"无空格键\!",\!r\!nsubstr(:SP_TOOL,8,3)\!r\!n)\!r\!n);*/\!r\!n\!r\!nTB = dt << Tabulate(\!r\!n    Show Control Panel( 0 ),\!r\!n    Add Table(\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_DATE ),\!r\!n            Add Aggregate Statistics( :ATTACH_DATE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_LINE ),\!r\!n            Add Aggregate Statistics( :ATTACH_LINE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :TOOL_CODE ),\!r\!n            Add Aggregate Statistics( :TOOL_CODE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :SP TOOL ),\!r\!n            Add Aggregate Statistics( :SP TOOL  )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :BUILD_STAGE ),\!r\!n            Add Aggregate Statistics( :BUILD_STAGE )\!r\!n        ),\!r\!n        \!r\!n        \!r\!n        /*Row Table(\!r\!n            Grouping Columns( :REMARKS ),\!r\!n            Add Aggregate Statistics( :REMARKS )\!r\!n        )*/\!r\!n        \!r\!n    )\!r\!n);\!r\!n\!r\!nTB << Move window( 1600, 100 );\!r\!n"),Margin({Left(0), Top(4), Right(4), Bottom(4)}),),
ButtonBox(title("包装1和正常追溯合并"),scriptText("//!\!r\!nNames Default To Here( 1 );\!r\!n//判断桌面是否有 JMP 文件\!r\!ndrijmp = Is Directory(\!"$Desktop\!\All\!");\!r\!n//如果没有就创建一个 JMP 文件夹\!r\!nif (drijmp == 0,\!r\!nCreate Directory(\!"$Desktop\!\All\!" ));\!r\!n//设置桌面 JMP 文件夹为默认目录\!r\!ndri = Set Default Directory(\!"$Desktop\!\All\!");\!r\!n\!r\!n//批量导入需要合并的文件，默认参数，JMP 自动推导，可手动配置参数。\!r\!nmfi = Multiple File Import();\!r\!n//设置导入目录\!r\!nmfi << Set Folder(dri);\!r\!n//设置导入的编码为中文字体\!r\!nmfi<<Set Charset( \!"gb2312\!" );\!r\!n//批量导入\!r\!nmfi << Import Data();\!r\!n\!r\!n//获取已经开的所有表数量\!r\!nopen_tables = N Table();\!r\!n//判断数据是否合并为 1 个，如果不是说明数据格式一致。\!r\!n//如果合并发现多余2个表弹窗提醒并停止下面代码继续执行。\!r\!nif (open_tables>1,\!r\!n    win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"请检查数据\!\!r数据格式不一致\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n    Stop(),\!r\!n);\!r\!n\!r\!n//导入后定义当前活动表为 datatable\!r\!ndt = Current Data Table();\!r\!n\!r\!n//判断有没有活动表,如果没有停止运行.\!r\!nif (\!r\!n\!tIs Empty(dt),\!r\!n\!t win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"桌面 All 文件夹为空\!\!r请检查文件\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n\!tStop();\!r\!n);\!r\!n\!r\!n//获取总行数\!r\!ncol = Length(dt << Get Column Names);\!r\!n\!r\!n//匹配重复的 SN 并删除行\!r\!ndt << Select Duplicate Rows( Match( Column( \!"MB_SN\!" )) ) << Delete Rows;\!r\!n\!r\!n\!r\!n//统计当前表总共多少行数据\!r\!nallrows = N ROWS(dt);\!r\!n\!r\!n//格式化 attachedate 为 年/月/日 时/分/秒\!r\!nColumn( \!"ATTACH_DATE\!")<< Data Type(numeric,Format( \!"y/m/d h:m:s\!"));\!r\!n\!r\!n//今天日期\!r\!ntoday = Short Date( Today()-24*3600 );\!r\!nydyformate = Substr(char(today),1,2)||Substr(char(today),4,2)||Substr(char(today),9,2);\!r\!n\!r\!n// 替换 Ai7 为 A17\!r\!nLocal( {dt = data table(\!"Sheet1\!")},\!r\!n\!tdt << Begin Data Update;\!r\!n\!tFor Each( {col},\!r\!n\!t\!tdt << Get Column Reference( dt << Get Column Names( Character ) ),\!r\!n\!t\!tFor Each Row( dt, col[] = Substitute( col[], \!"AI7\!", \!"A17\!", <<IGNORECASE ) )\!r\!n\!t);\!r\!n\!tdt << End Data Update;\!r\!n);\!r\!n\!r\!n\!r\!n//保存为桌面\!r\!ndt << Save As(\!"$Desktop\!\X1726-ISO Ramp \!"||ydyformate||\!" GODA Qty\!"||char(allrows)||\!" pcs V1.0.xlsx\!");\!r\!n//关闭数据表\!r\!n//dt << Close Window;\!r\!n\!r\!n//分割箱号\!r\!ndt << Text to Columns( columns( :PACK_ID ), Delimiters( \!" \!" ) );\!r\!n\!r\!n//重命名分割的列并删除多余的列\!r\!n:PACK_ID1 << Set Name(\!"机种国别\!");\!r\!n:PACK_ID2 << Set Name(\!"客户\!");\!r\!n:PACK_ID3 << Set Name(\!"MB厂商\!");\!r\!n dt << Delete Columns(:PACK_ID4);\!r\!n \!r\!n//此方法也可以分割箱号，但是效率慢\!r\!n\!r\!n//New Column( \!"机种国别\!", character );\!r\!n//For Each Row(:机种国别 =Items(:PACK_ID,\!" \!")[1]);\!r\!n//\!r\!n//New Column( \!"客户\!", character );\!r\!n//For Each Row(:客户 =Items(:PACK_ID,\!" \!")[2]);\!r\!n//\!r\!n//New Column( \!"MB厂商\!", character );\!r\!n//For Each Row(:MB厂商 =Items(:PACK_ID,\!" \!")[3]);\!r\!n\!r\!n//新建 SP TOOL\!r\!nNew Column( \!"SP TOOL\!", character );\!r\!n\!r\!n//判断空格键\!r\!n If(   col  == 17,\!r\!n \!tdt:SP TOOL << Set Formula( Substr( :SP_TOOL, 8, 3 ) ),\!r\!n \!tdt:SP TOOL << Set Formula( char(\!"无空格键\!") ),\!r\!n );\!r\!n \!r\!n/*For Each Row(\!r\!n:SP TOOL = If( Is missing(:SP_TOOL),\!r\!n\!"无空格键\!",\!r\!nsubstr(:SP_TOOL,8,3)\!r\!n)\!r\!n);*/\!r\!n\!r\!n//转换日期为字符串\!r\!ndt:ATTACH_DATE << Data Type(numeric,Format( \!"y/m/d\!"));\!r\!ndt:ATTACH_DATE << Data Type(Character);\!r\!n\!r\!n//制作数据表\!r\!nTB = dt << Tabulate(\!r\!n    Show Control Panel( 0 ),\!r\!n    Add Table(\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_DATE ),\!r\!n            Add Aggregate Statistics( :ATTACH_DATE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_LINE ),\!r\!n            Add Aggregate Statistics( :ATTACH_LINE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :TOOL_CODE ),\!r\!n            Add Aggregate Statistics( :TOOL_CODE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :SP TOOL ),\!r\!n            Add Aggregate Statistics( :SP TOOL )\!r\!n        ),\!r\!n        Row Table(\!r\!n            Grouping Columns( :机种国别 ),\!r\!n            Add Aggregate Statistics( :机种国别 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :客户 ),\!r\!n            Add Aggregate Statistics( :客户 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :MB厂商 ),\!r\!n            Add Aggregate Statistics( :MB厂商 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :BUILD_STAGE ),\!r\!n            Add Aggregate Statistics( :BUILD_STAGE )\!r\!n        ),\!r\!n        \!r\!n        \!r\!n        /*Row Table(\!r\!n            Grouping Columns( :REMARKS ),\!r\!n            Add Aggregate Statistics( :REMARKS )\!r\!n        )*/\!r\!n        \!r\!n    )\!r\!n);\!r\!n// add tool_code counts\!r\!ndt << Tabulate(\!r\!n\!tShow Control Panel( 0 ),\!r\!n\!tAdd Table(\!r\!n\!t\!tRow Table(\!r\!n\!t\!t\!tGrouping Columns( :TOOL_CODE, :ATTACH_DATE ),\!r\!n\!t\!t\!tAdd Aggregate Statistics( :TOOL_CODE )\!r\!n\!t\!t)\!r\!n\!t)\!r\!n);\!r\!n\!r\!nTB << Move window( 1600, 100 );\!r\!n"),Margin({Left(0), Top(4), Right(4), Bottom(4)}),))),
OutlineBox(
open(1),title("纬创备品脚本"),closeOrient(1),indent(13),default font id(2),scriptable,sub(
ButtonBox(title("纬创备品"),scriptText("//!\!r\!nNames Default To Here( 1 );\!r\!n//判断桌面是否有 JMP 文件\!r\!ndrijmp = Is Directory(\!"$Desktop\!\JMP\!");\!r\!n//如果没有就创建一个 JMP 文件夹\!r\!nif (drijmp == 0,\!r\!nCreate Directory(\!"$Desktop\!\JMP\!" ));\!r\!n//设置桌面 JMP 文件夹为默认目录\!r\!ndri = Set Default Directory(\!"$Desktop\!\JMP\!");\!r\!n\!r\!n//批量导入需要合并的文件，默认参数，JMP 自动推导，可手动配置参数。\!r\!nmfi = Multiple File Import();\!r\!n//设置导入目录\!r\!nmfi << Set Folder(dri);\!r\!n//设置导入的编码为中文字体\!r\!nmfi<<Set Charset( \!"gb2312\!" );\!r\!n//批量导入\!r\!nmfi << Import Data();\!r\!n//获取已经开的所有表数量\!r\!nopen_tables = N Table();\!r\!n//判断数据是否合并为 1 个，如果不是说明数据格式一致。\!r\!n//如果合并发现多余2个表弹窗提醒并停止下面代码继续执行。\!r\!nif (open_tables>1,\!r\!n    win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"请检查数据\!\!r数据格式不一致\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n    Stop(),\!r\!n);\!r\!n//导入后定义当前活动表为 datatable\!r\!ndt = Current Data Table();\!r\!n//判断有没有活动表,如果没有停止运行.\!r\!nif (\!r\!n\!tIs Empty(dt),\!r\!n\!t win = New Window( \!"错误提示\!",\!r\!n    <<Modal,\!r\!n    Text Box( \!"桌面 JMP 文件夹为空\!\!r请检查文件\!" ),\!r\!n    Button Box( \!"OK\!" ),);\!r\!n\!tStop();\!r\!n);\!r\!n//删除第一和第二列\!r\!ndt << Delete Columns(1,2);\!r\!n//设置胶水型号为 9088\!r\!nNew Column( \!"GLUE_BATCH\!", character );\!r\!ndt:GLUE_BATCH << Set Each Value(\!"9088\!");\!r\!n//设置胶水批次\!r\!nNew Column( \!"GLUE_TYPE\!", character );\!r\!n\!r\!n//设置机种为 Ramp\!r\!nNew Column( \!"BUILD_STAGE\!", character );\!r\!ndt:BUILD_STAGE << Set Each Value(\!"Ramp\!");\!r\!n//新建备注栏\!r\!nNew Column( \!"REMARKS\!", character );\!r\!ndt:REMARKS << Set Each Value(\!"备品\!");\!r\!n//重命名列名称\!r\!nNewCols = {\!"MB_SN\!", \!"ATTACH_DATE\!", \!"ATTACH_LINE\!", \!"TOOL_CODE\!",\!r\!n    \!"FIXTURE_CODE\!",\!"BR_TOOL\!",\!"SR_TOOL\!",\!"SP_TOOL\!",\!"RACK\!",\!"OVEN\!",\!r\!n    \!"AOI_ID\!",\!"JRS_ID\!",\!"PACK_ID\!"\!r\!n};\!r\!nFor( i = 1, i <= N Items( NewCols ), i++,\!r\!n Column( dt, i ) << set name( NewCols[i] )\!r\!n);\!r\!n\!r\!n//获取空格键的值\!r\!nSPValue = :SP_TOOL << Get Values;\!r\!n\!r\!n//如果空格键为空删除整列\!r\!nIf( Is Missing(SPValue[1]),\!r\!n dt << Delete Columns(\!"SP_TOOL\!"),\!r\!n);\!r\!n\!r\!n//获取总行数\!r\!ncol = Length(dt << Get Column Names);\!r\!n\!r\!n//匹配重复的 SN 并删除行\!r\!ndt << Select Duplicate Rows( Match( Column( \!"MB_SN\!" )) ) << Delete Rows;\!r\!n\!r\!n//格式化 attachedate 为 年/月/日 时/分/秒\!r\!n//Column( \!"ATTACH_DATE\!")<< Data Type(numeric,Format( \!"y/m/d h:m:s\!"));\!r\!n\!r\!n//统计当前表总共多少行数据\!r\!nTotalRows = N ROWS(dt);\!r\!n\!r\!n//更改表名为总行数\!r\!ndt << Set Name(\!"Sheet1\!");\!r\!n\!r\!n//获取粘贴日期\!r\!nattdate = dt:ATTACH_DATE << Get as Matrix;\!r\!n\!r\!n//新建一列 Date 用来更新胶水日期\!r\!ndatecol = New Column( \!"Date\!", numeric,Format( \!"y/m/d\!") );\!r\!ndatecol << Set Values( attdate );\!r\!nColumn( \!"Date\!")<< Data Type(Character,\!"Nominal\!");\!r\!n\!r\!n//打开胶水记录\!r\!ndt2 = Open(\!"$Desktop\!\Glue.jmp\!");\!r\!n\!r\!n//更新胶水记录\!r\!ndt << Update(\!r\!n    With( dt2 ),\!r\!n    Match Columns( :Date = :Date )\!r\!n);\!r\!n\!r\!n//关闭胶水记录\!r\!ndt2 << Close Window;\!r\!n\!r\!n//删除最后一列\!r\!ndt << Delete Columns(\!"Date\!");\!r\!n\!r\!n//今天日期\!r\!ntoday = Short Date( Today()-24*3600 );\!r\!nydyformate = Substr(char(today),1,2)||Substr(char(today),4,2)||Substr(char(today),9,2);\!r\!n\!r\!n// 替换 Ai7 为 A17\!r\!nLocal( {dt = data table(\!"Sheet1\!")},\!r\!n\!tdt << Begin Data Update;\!r\!n\!tFor Each( {col},\!r\!n\!t\!tdt << Get Column Reference( dt << Get Column Names( Character ) ),\!r\!n\!t\!tFor Each Row( dt, col[] = Substitute( col[], \!"AI7\!", \!"A17\!", <<IGNORECASE ) )\!r\!n\!t);\!r\!n\!tdt << End Data Update;\!r\!n);\!r\!n\!r\!ndt << Subset(\!r\!n\!tKeep by columns( 1 ),\!r\!n\!tBy( :PACK_ID ),\!r\!n\!tAll rows,\!r\!n\!tSelected columns only( 0 ),\!r\!n\!t/*columns(\!r\!n\!t\!t:MB_SN, :ATTACH_DATE, :ATTACH_LINE, :TOOL_CODE, :FIXTURE_CODE, :BR_TOOL,\!r\!n\!t\!t:SR_TOOL, :SP_TOOL, :RACK, :OVEN, :AOI_ID, :JRS_ID, :GLUE_BATCH, :GLUE_TYPE,\!r\!n\!t\!t:BUILD_STAGE, :REMARKS\!r\!n\!t)*/\!r\!n);\!r\!n\!r\!ndataname = Get Data Table List();\!r\!n\!r\!nSubsetdri = Is Directory(\!"$Desktop\!\Subset\!");\!r\!n//如果没有就创建一个 Subset 文件夹\!r\!nif (Subsetdri == 0,\!r\!nCreate Directory(\!"$Desktop\!\Subset\!" ));\!r\!n\!r\!n\!r\!nfor (i = 1,i <= N Items(dataname)-1,i++,\!r\!n\!r\!n\!tdataname[i] << Save (\!"$Desktop\!\Subset\!\纬创 \!"||Regex( char(dataname[i]),\!".*=(.*\!\d).*\!",\!"\!\1\!" )||\!" 备品.xlsx\!");\!r\!n\!t\!r\!n\!tdataname[i] << Close Window;\!r\!n\!t\!r\!n);\!r\!n\!r\!ndt = Current Data Table();\!r\!n\!r\!n//保存为桌面\!r\!ndt << Save As(\!"$Desktop\!\\!"||char(longdate(today()))||\!"-\!"||char(TotalRows)||\!" pcs 备品.xlsx\!");\!r\!n//关闭数据表\!r\!n//dt << Close Window;\!r\!n\!r\!n//分割箱号\!r\!ndt << Text to Columns( columns( :PACK_ID ), Delimiters( \!" \!" ) );\!r\!n\!r\!n//重命名分割的列并删除多余的列\!r\!n:PACK_ID1 << Set Name(\!"机种国别\!");\!r\!n:PACK_ID2 << Set Name(\!"客户\!");\!r\!n:PACK_ID3 << Set Name(\!"MB厂商\!");\!r\!n dt << Delete Columns(:PACK_ID4);\!r\!n \!r\!n//此方法也可以分割箱号，但是效率慢\!r\!n\!r\!n//New Column( \!"机种国别\!", character );\!r\!n//For Each Row(:机种国别 =Items(:PACK_ID,\!" \!")[1]);\!r\!n//\!r\!n//New Column( \!"客户\!", character );\!r\!n//For Each Row(:客户 =Items(:PACK_ID,\!" \!")[2]);\!r\!n//\!r\!n//New Column( \!"MB厂商\!", character );\!r\!n//For Each Row(:MB厂商 =Items(:PACK_ID,\!" \!")[3]);\!r\!n\!r\!n \!r\!n//新建 SP TOOL\!r\!nNew Column( \!"SP TOOL\!", character );\!r\!n\!r\!n//判断空格键\!r\!n If(   col  == 17,\!r\!n \!tdt:SP TOOL << Set Formula( Substr( :SP_TOOL, 8, 3 ) ),\!r\!n \!tdt:SP TOOL << Set Formula( char(\!"无空格键\!") ),\!r\!n );\!r\!n \!r\!n \!r\!n/*//判断空格键\!r\!nFor Each Row(\!r\!n:SP TOOL = If( Is missing(:SP_TOOL),\!r\!n\!"无空格键\!",\!r\!nsubstr(:SP_TOOL,8,3)\!r\!n)\!r\!n);*/\!r\!n\!r\!n//转换日期为字符串\!r\!ndt:ATTACH_DATE << Data Type(numeric,Format( \!"y/m/d\!"));\!r\!ndt:ATTACH_DATE << Data Type(Character);\!r\!n\!r\!n//制作数据表\!r\!nTB = dt << Tabulate(\!r\!n    Show Control Panel( 0 ),\!r\!n    Add Table(\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_DATE ),\!r\!n            Add Aggregate Statistics( :ATTACH_DATE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :ATTACH_LINE ),\!r\!n            Add Aggregate Statistics( :ATTACH_LINE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :TOOL_CODE ),\!r\!n            Add Aggregate Statistics( :TOOL_CODE )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :SP TOOL ),\!r\!n            Add Aggregate Statistics( :SP TOOL )\!r\!n        ),\!r\!n        Row Table(\!r\!n            Grouping Columns( :机种国别 ),\!r\!n            Add Aggregate Statistics( :机种国别 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :客户 ),\!r\!n            Add Aggregate Statistics( :客户 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :MB厂商 ),\!r\!n            Add Aggregate Statistics( :MB厂商 )\!r\!n        ),\!r\!n        \!r\!n        Row Table(\!r\!n            Grouping Columns( :BUILD_STAGE ),\!r\!n            Add Aggregate Statistics( :BUILD_STAGE )\!r\!n        ),\!r\!n        \!r\!n        \!r\!n        /*Row Table(\!r\!n            Grouping Columns( :REMARKS ),\!r\!n            Add Aggregate Statistics( :REMARKS )\!r\!n        )*/\!r\!n        \!r\!n    )\!r\!n);\!r\!n\!r\!nTB << Move window( 1600, 100 );\!r\!n"),Margin({Left(0), Top(4), Right(4), Bottom(4)}),))),
ListBox(vertical,near,),
ListBox(vertical,near,),
ListBox(vertical,near,),
ListBox(vertical,near,),
ListBox(vertical,near,sub(
IconBox(title("Locked"),Margin({Left(-200), Top(0), Right(0), Bottom(0)}),)))))
/* preview image PNG (v=1,x=141,y=298,b=5736,c=96,d=126,e=42,f=92,g=59,h=34,i=39,j=47,k=44,m=A5209B3AE6A447C16681310DEC0725A5)
=v}uA%:{<d&52G3ALL(OUZ:Fe4kjyV!!!84v7%+-!!!!_=wLI4kK=3<!!-=)<#fB$!!$Abz!YXr!!!67>>vs>!!&+I!!&.XpDyf7!2nY|>k?G+Mb<{{e@PCy(8GX04w+EDy1J-&L=&i^.!3|1!qcbDPopJw!3sb[lQ)U0.O-Vn9I+CAzrMv<=B](_i8N-Cjv=[fP&{u{:]zOn(lM!W$hxvK:_f6&P#o10_AIr>cxIQ|pSJpVj3}tr&=!C8.jsi&b24sIz]$fA(JzbFzNFOMeHkyJZs=Y4zQLr)xa?njfZuiRsD].%i=X!-1a)z5r[$Mh
Lq8vPVSN3ekXleAG?M4z52GsqQBSv!@[{W6f>JOWzN3yIkf}ic$L&q:V[7a]6i{ETMPF_fAU}f-]g?0U&ZapMd3|1a%H3O1<wqC806c6Y=+6x%00OXBj?nkGK>+XjWY1VE4N_)nFd>6Te=({F3%1IfvjzC]2P>euM[D@C3Iwk#1F1Xt=cjYl9n>tFiZ@R]glzvuWZ]|Kyp1]XTu_Y:aKcKdVa1N6jYRp&hrthN9k#cVp|nLNa>7.[<ec>JzcC1!3Lnl&Eucf%y7rkMH0TYyF_(!Qq2COZG2dDu(tuVr&:ilz3:Ii^(w86=v99i:%)<Ux
6-O.(gdRl$e)uH(7Vk6Ryz[9k1rLL>r!(ym=^h(:XP+yHLlDt[jHNFm%<q48EN6)<rFu{m]s5CHh=4sL9+)!k7k3YhGH2k|xDHjJYQ4I0S%2Rr>P.g8yshGt$[sw[jU#V2:1%BqsNDsOS85daSyMD>oMCXY@hIP3d_$Ij+$bcpxI&q=W?j!96dLArq9[D1A02gP4y3k9NT!r[A+>z?4A!=gS9(fBtortBk]#=uy5CV24E+KO(c-oD6UPb$rFsCv=_5kfS_W%&D@h6+({hBqyn<WJ(x8b)HMyNtXE_fL>ubLFkdr8MkGdhOUj$?&N@nzT
fV#Cbu#uN#?xWH=1i>gI%&(G31Bv)c^I8cP&x8%h:iTqDi3dxn>Dd0oQjQ0z:Rp1oY#<+1xXn+0nxDa761&<Q1r2OT[mOWjb<g<k44nIkr}K>z[%v798[Y@H?g#IjOp<=[doJ?Ixb[a-RAR&eDrX^HWDH!YWk:HV0Eh{i)3ME^r>o|iq#ugIY)!x+Ip_kAy4GfPb(o!+[A7[c$1!4.&tLG$2^o{3PYz0}0?8ZpS%%Wl#F{Mel8@2syY2IFv1.0iwJ48eF34EBPb0J0mZ?x#R^=c+@dt3JJ7INQ(ti#_[cm2_P#Vx+QV3[4uOxH&Gcaf6
EG5#s1BgAG^YjBt:Z2@e6m>Q3bWz)Jf@wLXa@wUfEo^ja<fWL&(cw}=E9l1!llp-aU#Moy1a4}of:8E054.&:1iv]=Wppcg.)f3WG]gkd1WrLW2AF_0T.cYmkSeI[3tN|EysFaA.j@.5:P(v#9gF<Nb<)|&+Viq0qVHu=ULVwr>8grr?^MKK<2pN7(#UFokDh9S=Af$lM(8vSruz#(tY@sa1F}cvV<p=E1}:9lQ6fV+IBDx9<lT&hwS#u6w3t(>)4gxtqNG$up&Ie?G9]}_S#rWOUl_.gt?>]A6lwMe>vqAQ&BH[P.M3r+vvif1baeja
1&w}i]:jA^OG4&6IUQ[c]qh3XVFaCV0Q[Kej_y_5iH^oFMV0F2=#Uc&HZnJU-)]E:>2@dDsh]dlz[?R_hE64ewGrVqWq:=vbMf.)sh]duM!J]LH=6jgkgeqPy>R$[b$HI<>z[76BDxN:#JF9C2-mwm!D:G<^!PPH&=!C90JR{)RxQvqfVmOOA&pGyzcycgQRw&R@s>DU^Nw=SItP)m!qRS=S$g3K&0273e%2?b)#p{-G>#jI8?Fn80GJ2N1ke+Tmf[Xu1+v>D(%:T>X[Ud2_:@kWFBa0wT5|AGxGsVEC.t=N.p+M@1Z.r&U_qH&qATt$
xrrXR(OvK]9w6ST-C=^MLlg&}.jIX1pDT}bi5w|Z<ous69XL:Y@TZ2]-9^S<?vvSIi0^9cz%^XHp_)8eI>07!G_WeN<IfuY<9DqP)!tyb4-o([!ch@(jtDf#<7Vg]^rF(N?Uxq[.Z+D$1YT?DV1m}&O)m^i(Woo53ncW:GP8Tl>3$-<0sFNU2EZ?S!d+jl$dlQV8)_wx_=xc?(l1CO83P%U>BCKn!<t1d1kPn|:fbpXDn&jj1kK|[.}E[Z!!9OLUDX&U=#S?H!cP9E@gCojWxkj@m>A{aFnwXFA=EN]xxt(R)S71Ux4P$AOlR{6Gz2Ym
0IxB4U^a+cKc=c4Wgyo1+@^w&3)@6d$caPL12zUk:(Yb(7ND6CQ0fNlnRt@d>cK-89%3>EU{I2-M!yBu6?Jjctv}0JqK0]DO|SP]W(9Hat0&>$Xtud![Z]Tz_TA+[?m3JZ#D@u#%]7V=&0=8EUP:_<HZ]Y)p5{-!1a3}y_Vwvc]Ti_|vypDn_jOW!(lcsi>Bw6rdU9d7X3N+O0{yM$)?M%L&8h?!=)0QIH?:s92}paN?0qLa1a53t[:?mxDgte=hgJVt3&5)FU@>]E(qL>tK]UJhU-ED}E0{B0=#Wj81kdkT>Up%Niztqg)L0Z|qp(kA
pZkzNG9h(UR[eb-y.E<El0Vf!wR{uB[43rYGARI)0@W_E1#ln]QKwQEhWZS}1#lRvPiulg0?8ZpS%%Wl#F{MeZNbaT7%#Bwd].S84UvRqr|Pa-VwLb%&}bnIZoa3Uk_ng>MUL()$()-P(lIuoi]#Z}wR0N{P[j.R[tX)<-2&y#VH{!xi]#p<xvIUCfFe.rYV2_V?@cBHtlLtc26c-%y!nf54[%XU+:=2:J?bE!RR|?OyyX$Ut!C:AwU{I$7-e6-Z=SAu<ph:DVN1ePUlZp(Dn9qxX6xAj2!#gv=VfIb.BAP}-(<loDLk5OzC6()L(L><
PEs$?Pr26+w56du7:55X#pN%NuX:8}SVg>R(bRW+8ShI0R5DxQG]kXxNh{rdQ{Z(6t$cS3gr2e-m4uzKocbcwxXcQq3sO^e6ldc$2mw{TqR)VWRu%=e=#gq=S2s=+)%bvbOH63VT4e.z%)pq2L)EuR_YCp&pr$}9a-.Hzp&Lvr(1b76lC?L_)$t!y)3l=fr9R+5=#Zk>l8r}6GARFR0@W_E1#ln]QKwQEhWZS}1#lRvPiulg0?8ZpS%%Wl#F{MeZNbaT7%#BwPb(r?1Xu#1(QsnqPALG-m2(Ad{3[oB:pkUgRx?6&Jn?Vf=#TPB!cP9E
l9_r&4cV(PAbCh6.9cysth[8hjTP#hu}SI1jsaoL8VuUuhZ2o|i=X1gdY!{UBHOG5yUJWotPyB_DsFJ=3dey}0ab=x5OJ&CTI>iz?aLf5DH|aJeXVF+A)>MZ1vj0]L]$z:kJSrZN8D]gw?pfrfN38zh$eY!^<dW^{.]rZU{Jd40cpI%!aMpI)^F1PU{a8_l93Af8oBCLv{[!1jejc(Kca^q3%iEp3U@yza&TWz2]ddTooFhe83GL0mRQq=Y&4roml0b8UF#lRWuWPxTk@HK+!Ftr48PRz=XaK8iP^<mr3Ej@3FKiEGRN.G$zTFwx9$lR
mOiF#nEAa{0DhK(NEbWZ$foHa0BKrwo&0yV7D|Bm%=-zE#NaD68tSgiJN|VUL[HHa=MeG@CBG1!5Y<b4x&Xnp8vF?KB7.QBsY8s5FFE$-I9M^x%8g1>6-bCT14!xWb<s+=X3k>nv?tCSzTqgW@Qd<L2(pFaU_=+<1&by%6^7}m<>nHW3jYOl(Rob=<g.t21&[Z.mA0n(l3wzK&Eb>e74sc&D7gtZY[SjYWCpTi@mtv!pQvqd)!I]y6?bMU%9p|mrj#H@!H}]QWC>w}K>N)RG6S#n9JN#:AE7s|u]cC|#_5!a$[x5uGby4EX&@v{SfleC
&9d)Ca(_$nqfn5nsIL?<7%#BtPb(r?k2>RG:pkDlWJ%U$#FzR}ZNbaT7%#Bwtp!h040M@KZ>H6mxVUMjRthGf:+.1JJ$ZJy[&&q-VTphD=xE7S029myjlby)$oc)Zoc9^-jGCLHeiE%h=_N[iAvuRiP7?ZKHZU}As#+XBbO)@8^y|JA?3Z+}troH?gpfyAJZ2-8YFTFWBmYa>ME<<LX8Lwo4<$3bD!V>W=&YV69)!ttREH&|Z:MSt&[MVV1^Fvl1%d?<s9&@L(3dwAKfa}uT_-.nx&ZhCRIXbx:4_&.1@U[+yCvyq0p?@z)$SsZZku{0
s8:I(c[Ts_n6?E]_([Ena(sCmn)8}b>BJKLz4!fU?4?vbUF1SnYlnDByHnMrTc_#+Wn2#9jqCHq]N4PcQ2bY3VKwzU69wpWxl+8CU5vS-=+BdrW&C8qk+%SkCnK$A9JWx%C]C@D$:{Js>>W:k+2S@OD6mj.n.MCS7gul[4Mb<1S1Rc|mj3zCuJqZ{!Texv4b{pjt:4<-U$5Uh0<:{YkKIGkN%}1)86X}35zCf<U_SmtS&?[a7T|K3=&3cfzLDoW=]B1q>GfSw0<$N}5mE-LqY#qiu4nb!S%]Ca=+HSi!2W+5y=|242WxWGWJ!@n4Ucg-
1Z5rB)+^z4>BDVp!<t1d1kPn|NqB{E>-{3Dy(4V+{-d$<av|[L1kPv(U<E27dZbPvO9w(=k=Y<tSozS!B0^CU^=7It1Bxna4Uq>H$hw$}:_f6&I)$_q#(QXV=FPihDn17ExM#>|)&F4:5_rQ}ja.L&VtejESruxCO2-hq[3Z|-$$yi:azY?x#F1G4uss0aE0op#BT[b%9V=C2G6&.RG[tUUzhGO0l+S&CNj%Y)<c33^9FiupzsNwonjyS3$cn)RXJ$.i[g#xBjukjJa?X%7OMG%EEoF$cyx2tpk2c4i78qSf@NL.Fz7G8sh$qiul!g&f
+l_ZNLMD@3.^:qwW<.$KN_&^g?v3THmXJ=+]7on2V#?EexVP](YWI)pbGISj4(KTAIZSp&z(rw|Z%.=rPZ?w7RE07#fQjQ}8fvp.O^1culqg2Qy&H3R8?!Rn>iMzFkM9Acl6Z9Y0g6}rDy$Wkgp5yzjsPMNG{H<_p5[DL^Eenj2@-4}z0p{WsGrTjIA!PzAGj#Hh5!233jFCx2=4SIU_-P+XBV_HiZiJXA)HA7r3^(qFTdn<j>s|a6!qOA&KPAJOw|q0w5a+Hx_.4nU^}Im7BvMSx1RyTWs8tuGQb|$(vLPiy}r.N-I2r3JYBOm-.s>F
[3xxbc[pByH7pNDL3s0az}|RNnrsW+Q6+t--Zmzb><c3qq?-&q##Y^KGnR+.X<l)6UbC7in@C5cxUJ85?a|rvISbV.PKLR<@>(BC+4bXS?do6|E<Zl-qZHNj-(=c^u#vATsC9VrXFmq&B>7m^xsi<-<qUimSz%&(Gt_Nx>H6Y&B&2=Ryg[U)@1xv{vLQmWoHc7tajMN8xshf:w5%{%7DE:4uN$!=8g4+vJYBk(XkEsW$L:]I-SM(T$:]BTS)gbg)Ls_g1!wH|OtqYzn&i8+mNT]34r0K83%F-0vy0EgQ[txk1$:<?RGQoKvPn]0YS}mX
ipICju&XcV>NgDR@E7Ma:c4t^8A8i77vIYmDG[f:hWm@[XcVV.dN:zs#G2$1ckG0iXvQ7WnxmJ.!D:H}HZu^|d00TZ.[nT@cHzS&F[(^B^#4XO6y#YXja.L&c4w3c1!b1z!D:[5^!PPH&=!C90JR{)S%%Wl2..PjQ7n[ctj|(rN<nMZ3o+2L7%#BtN-S#6zF^yMMU.#hOj}[6NF1EMu!qkJ>[MpBYfDf>mJjS&vjz&88pAU<ncn)fO4b.Pdwm?^M6t[5u{k2Z:8@S|@36XUt6dpC:%9%L3%pwMUJ+Kw$|:PhI{bh[VvM#DtXCi9h1p{.
ivH4lxd(0gH[=8IE>!J_V?hc8L}KAuMWLCPHm]vD#a@)lv|PnlU|g$DeX?2ZTmv^qUN+De=&#{1UHgxj-GMtuRkM]wa3KFZ^#Zipi)kvQb4Sya1_y.M2Gm&^Ajn|}3S#MUI6y?_f[.vzI:M<e.kzHW)5)rBdf>Hf-a5C+VqM50^iQ]cjO1sok]}y]=(K)ix8_qu@hVdDF.4y:B+^}!42pLK&.Y]B4@2g&KL!e$&_ZH!2CvMyr87YZ2ex7TIHX]brqP4q1a.Koyn[}HvAkc9v%aMmeR>$Ccph@(vU3wXB@l{r-0wx<Czxt?^rI)N[5HP7
>w3&Mwy3B0A[!Uqd?H|EE?.fUB0[tS[4:<dbiX]nHHkz6%Q0mEmnv5@tJ-qg6b?}%h?BI$tRoQz&wY=+ocZr^S%>}24nmZO8|Gw$lQVs!FFDz}uq77QcUF:-_PNP1NT!]Y[4qC|0Y4cEH]y8RP@0H1daB[X?eTaz<jXx+RGY<7#]=%|DtivPj+N8IqBH5qREtA33%a&MpMXvi7&s(e=#LEKqI+nf1#^-@m]&:EbNSb!xYvu.gyXWUd9=hZ-{<4S1Wn)NBPq&vX{w7gK5]+xmsFWSepml>2@>n%2Im^{V3]wntX>#Bc>%C.!rxuCWepOp
GuVz56>[.O<yN6f&<J=X.exfkH7_f&0?w&wS%%Wl#F{Me=&EHpvUZ8a?88LT(kj5#$hxvK:_f6&4aar{MBfsiKd=)Mf{skcOp1_kDUh_#cabQxYMrYBiRI3lEG5#t1BgAGdgs$):XL4Sl8-st5c]!MD@D^I3zEgWvH-GL3}Cg?oAiQf^ygHSE2KIA(l:7jS&iyD$.=tituqJpz6MG..k}-R:xjk5v5+D^1j>S@j@yBlSJGf>zW|x[_Z-Vd%+$pI0G5zKlE<up41TzQjKiN]nAlw{cuaqt?Yu6pTiB=Y5@3f4!nO6{-+5B1k2Qf(-4|o<
)&z)tJ@}n64DE5P0ZX]yPIzFu)tr<&y:rr>Wi[H(bcdG[VaH%wXFm--+6Ky(%9ePRH$$2v]8n@fw3XrV-{xZ}0-M<4(mTYy=+HW9GW>5V]dJZ6Q0?As&3Uz|9kd7hhxJFh?-K)J3E:714Grt1Nx6Ia)3?7bP-kNBzUQl^UF=<^GJMk#V>V$vi.<6=h+C2j18$o57fk?V-Ri-{(Wr-:Z=Cw.ld67)Vz&0hGPMs39+CxeG_f6[J)$J|.^{=d$a=E9QxpZ=j1-te6)+<3puyXr:n!-9l8-st5c]!McHzS1_WZ.Ma!x-AtaI5{1EhFU2!bF^
wymw.5cS!9:Wrge7%#BqPb(r?1Xu#1(QsnqPALG-m2(Ad$1!4.UDX&U=#S?H!cP9E@gCoj-S!aN:p$x2(lM!W$hxvK:_f6&>ko=O#?>-wFq8#2vrjKE!!!!!<z%5HPufxP
 */
